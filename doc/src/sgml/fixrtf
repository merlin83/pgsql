#!/bin/sh
# fixrtf
# Repair (slightly) damaged RTF generated by jade
# Applixware wants the s0 stylesheet defined, whereas
#  M$Word does not care about it.
# (c) 2001, Thomas Lockhart, PostgreSQL Inc.

flist=$@
if [ "$flist" = "" ] ; then
  flist=*.rtf
fi

for f in $flist ; do
  echo -n "Repairing $f..."
  if [ -r $f ] ; then
    (sed 's/{\\stylesheet{\\s1/{\\stylesheet{\\s0 Normal 0;}{\\s1/g' $f > $f.new \
      && mv -f $f.new $f \
      && echo " done") || echo " failed"
  else
    echo " file not found"
  fi
done
exit
