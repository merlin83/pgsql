QUERY: insert into rtest_t2 values (1, 21);
QUERY: insert into rtest_t2 values (2, 22);
QUERY: insert into rtest_t2 values (3, 23);
QUERY: insert into rtest_t3 values (1, 31);
QUERY: insert into rtest_t3 values (2, 32);
QUERY: insert into rtest_t3 values (3, 33);
QUERY: insert into rtest_t3 values (4, 34);
QUERY: insert into rtest_t3 values (5, 35);
QUERY: insert into rtest_v1 values (1, 11);
QUERY: insert into rtest_v1 values (2, 12);
QUERY: select * from rtest_v1;
a| b
-+--
1|11
2|12
(2 rows)

QUERY: delete from rtest_v1 where a = 1;
QUERY: select * from rtest_v1;
a| b
-+--
2|12
(1 row)

QUERY: insert into rtest_v1 values (1, 11);
QUERY: delete from rtest_v1 where b = 12;
QUERY: select * from rtest_v1;
a| b
-+--
1|11
(1 row)

QUERY: insert into rtest_v1 values (2, 12);
QUERY: insert into rtest_v1 values (2, 13);
QUERY: select * from rtest_v1;
a| b
-+--
1|11
2|12
2|13
(3 rows)

QUERY: delete from rtest_v1 where b = 12;
QUERY: select * from rtest_v1;
** Remember the delete rule on rtest_v1: It says
** DO INSTEAD DELETE FROM rtest_t1 WHERE a = current.a
** So this time both rows with a = 2 must get deleted
a| b
-+--
1|11
(1 row)

QUERY: delete from rtest_v1;
QUERY: insert into rtest_v1 select * from rtest_t2;
QUERY: select * from rtest_v1;
a| b
-+--
1|21
2|22
3|23
(3 rows)

QUERY: delete from rtest_v1;
QUERY: insert into rtest_v1 (b, a) select b, a from rtest_t2;
QUERY: select * from rtest_v1;
a| b
-+--
1|21
2|22
3|23
(3 rows)

QUERY: insert into rtest_v1 (a) select a from rtest_t3;
QUERY: select * from rtest_v1;
a| b
-+--
1|21
2|22
3|23
1|  
2|  
3|  
4|  
5|  
(8 rows)

QUERY: select * from rtest_v1 where b isnull;
a|b
-+-
1| 
2| 
3| 
4| 
5| 
(5 rows)

QUERY: update rtest_t1 set a = a + 10 where b isnull;
QUERY: delete from rtest_v1 where b isnull;
QUERY: select * from rtest_v1;
a| b
-+--
1|21
2|22
3|23
(3 rows)

QUERY: update rtest_v1 set b = 42 where a = 2;
QUERY: select * from rtest_v1;
a| b
-+--
1|21
3|23
2|42
(3 rows)

QUERY: update rtest_v1 set b = 99 where b = 42;
QUERY: select * from rtest_v1;
a| b
-+--
1|21
3|23
2|99
(3 rows)

QUERY: update rtest_v1 set b = 88 where b < 50;
QUERY: select * from rtest_v1;
a| b
-+--
2|99
1|88
3|88
(3 rows)

QUERY: delete from rtest_v1;
QUERY: insert into rtest_v1 select rtest_t2.a, rtest_t3.b where rtest_t2.a = rtest_t3.a;
QUERY: select * from rtest_v1;
a| b
-+--
1|31
2|32
3|33
(3 rows)

QUERY: update rtest_v1 set b = rtest_t2.b where a = rtest_t2.a;
QUERY: select * from rtest_v1;
a| b
-+--
1|21
2|22
3|23
(3 rows)

QUERY: insert into rtest_v1 select * from rtest_t3;
QUERY: select * from rtest_v1;
a| b
-+--
1|21
2|22
3|23
1|31
2|32
3|33
4|34
5|35
(8 rows)

QUERY: update rtest_t1 set a = a + 10 where b > 30;
QUERY: select * from rtest_v1;
 a| b
--+--
 1|21
 2|22
 3|23
11|31
12|32
13|33
14|34
15|35
(8 rows)

QUERY: update rtest_v1 set a = rtest_t3.a + 20 where b = rtest_t3.b;
QUERY: select * from rtest_v1;
 a| b
--+--
 1|21
 2|22
 3|23
21|31
22|32
23|33
24|34
25|35
(8 rows)

QUERY: insert into rtest_system values ('orion', 'Linux Jan Wieck');
QUERY: insert into rtest_system values ('notjw', 'WinNT Jan Wieck (notebook)');
QUERY: insert into rtest_system values ('neptun', 'Fileserver');
QUERY: insert into rtest_interface values ('orion', 'eth0');
QUERY: insert into rtest_interface values ('orion', 'eth1');
QUERY: insert into rtest_interface values ('notjw', 'eth0');
QUERY: insert into rtest_interface values ('neptun', 'eth0');
QUERY: insert into rtest_person values ('jw', 'Jan Wieck');
QUERY: insert into rtest_person values ('bm', 'Bruce Momjian');
QUERY: insert into rtest_admin values ('jw', 'orion');
QUERY: insert into rtest_admin values ('jw', 'notjw');
QUERY: insert into rtest_admin values ('bm', 'neptun');
QUERY: update rtest_system set sysname = 'pluto' where sysname = 'neptun';
QUERY: select * from rtest_interface;
sysname|ifname
-------+------
orion  |eth0  
orion  |eth1  
notjw  |eth0  
pluto  |eth0  
(4 rows)

QUERY: select * from rtest_admin;
pname|sysname
-----+-------
jw   |orion  
jw   |notjw  
bm   |pluto  
(3 rows)

QUERY: update rtest_person set pname = 'jwieck' where pdesc = 'Jan Wieck';
QUERY: select * from rtest_admin;
pname |sysname
------+-------
bm    |pluto  
jwieck|orion  
jwieck|notjw  
(3 rows)

QUERY: delete from rtest_system where sysname = 'orion';
QUERY: select * from rtest_interface;
sysname|ifname
-------+------
notjw  |eth0  
pluto  |eth0  
(2 rows)

QUERY: select * from rtest_admin;
pname |sysname
------+-------
bm    |pluto  
jwieck|notjw  
(2 rows)

QUERY: insert into rtest_emp values ('wiech', '5000.00');
QUERY: insert into rtest_emp values ('gates', '80000.00');
QUERY: update rtest_emp set ename = 'wiecx' where ename = 'wiech';
QUERY: update rtest_emp set ename = 'wieck', salary = '6000.00' where ename = 'wiecx';
QUERY: update rtest_emp set salary = '7000.00' where ename = 'wieck';
QUERY: delete from rtest_emp where ename = 'gates';
QUERY: select * from rtest_emplog;
ename               |who  |action    |newsal    |oldsal    
--------------------+-----+----------+----------+----------
wiech               |pgsql|hired     |$5,000.00 |$0.00     
gates               |pgsql|hired     |$80,000.00|$0.00     
wieck               |pgsql|honored   |$6,000.00 |$5,000.00 
wieck               |pgsql|honored   |$7,000.00 |$6,000.00 
gates               |pgsql|fired     |$0.00     |$80,000.00
(5 rows)

QUERY: insert into rtest_empmass values ('meyer', '4000.00');
QUERY: insert into rtest_empmass values ('maier', '5000.00');
QUERY: insert into rtest_empmass values ('mayr', '6000.00');
QUERY: insert into rtest_emp select * from rtest_empmass;
QUERY: select * from rtest_emplog;
ename               |who  |action    |newsal    |oldsal    
--------------------+-----+----------+----------+----------
wiech               |pgsql|hired     |$5,000.00 |$0.00     
gates               |pgsql|hired     |$80,000.00|$0.00     
wieck               |pgsql|honored   |$6,000.00 |$5,000.00 
wieck               |pgsql|honored   |$7,000.00 |$6,000.00 
gates               |pgsql|fired     |$0.00     |$80,000.00
meyer               |pgsql|hired     |$4,000.00 |$0.00     
maier               |pgsql|hired     |$5,000.00 |$0.00     
mayr                |pgsql|hired     |$6,000.00 |$0.00     
(8 rows)

QUERY: update rtest_empmass set salary = salary + '1000.00';
QUERY: update rtest_emp set salary = rtest_empmass.salary where ename = rtest_empmass.ename;
QUERY: select * from rtest_emplog;
ename               |who  |action    |newsal    |oldsal    
--------------------+-----+----------+----------+----------
wiech               |pgsql|hired     |$5,000.00 |$0.00     
gates               |pgsql|hired     |$80,000.00|$0.00     
wieck               |pgsql|honored   |$6,000.00 |$5,000.00 
wieck               |pgsql|honored   |$7,000.00 |$6,000.00 
gates               |pgsql|fired     |$0.00     |$80,000.00
meyer               |pgsql|hired     |$4,000.00 |$0.00     
maier               |pgsql|hired     |$5,000.00 |$0.00     
mayr                |pgsql|hired     |$6,000.00 |$0.00     
maier               |pgsql|honored   |$6,000.00 |$5,000.00 
mayr                |pgsql|honored   |$7,000.00 |$6,000.00 
meyer               |pgsql|honored   |$5,000.00 |$4,000.00 
(11 rows)

QUERY: delete from rtest_emp where ename = rtest_empmass.ename;
QUERY: select * from rtest_emplog;
ename               |who  |action    |newsal    |oldsal    
--------------------+-----+----------+----------+----------
wiech               |pgsql|hired     |$5,000.00 |$0.00     
gates               |pgsql|hired     |$80,000.00|$0.00     
wieck               |pgsql|honored   |$6,000.00 |$5,000.00 
wieck               |pgsql|honored   |$7,000.00 |$6,000.00 
gates               |pgsql|fired     |$0.00     |$80,000.00
meyer               |pgsql|hired     |$4,000.00 |$0.00     
maier               |pgsql|hired     |$5,000.00 |$0.00     
mayr                |pgsql|hired     |$6,000.00 |$0.00     
maier               |pgsql|honored   |$6,000.00 |$5,000.00 
mayr                |pgsql|honored   |$7,000.00 |$6,000.00 
meyer               |pgsql|honored   |$5,000.00 |$4,000.00 
maier               |pgsql|fired     |$0.00     |$6,000.00 
mayr                |pgsql|fired     |$0.00     |$7,000.00 
meyer               |pgsql|fired     |$0.00     |$5,000.00 
(14 rows)

QUERY: insert into rtest_t4 values (1, 'Record should go to rtest_t4');
QUERY: insert into rtest_t4 values (2, 'Record should go to rtest_t4');
QUERY: insert into rtest_t4 values (10, 'Record should go to rtest_t5');
QUERY: insert into rtest_t4 values (15, 'Record should go to rtest_t5');
QUERY: insert into rtest_t4 values (19, 'Record should go to rtest_t5 and t7');
QUERY: insert into rtest_t4 values (20, 'Record should go to rtest_t4 and t6');
QUERY: insert into rtest_t4 values (26, 'Record should go to rtest_t4 and t8');
QUERY: insert into rtest_t4 values (28, 'Record should go to rtest_t4 and t8');
QUERY: insert into rtest_t4 values (30, 'Record should go to rtest_t4');
QUERY: insert into rtest_t4 values (40, 'Record should go to rtest_t4');
QUERY: select * from rtest_t4;
 a|b                                  
--+-----------------------------------
 1|Record should go to rtest_t4       
 2|Record should go to rtest_t4       
20|Record should go to rtest_t4 and t6
26|Record should go to rtest_t4 and t8
28|Record should go to rtest_t4 and t8
30|Record should go to rtest_t4       
40|Record should go to rtest_t4       
(7 rows)

QUERY: select * from rtest_t5;
 a|b                                  
--+-----------------------------------
10|Record should go to rtest_t5       
15|Record should go to rtest_t5       
19|Record should go to rtest_t5 and t7
(3 rows)

QUERY: select * from rtest_t6;
 a|b                                  
--+-----------------------------------
20|Record should go to rtest_t4 and t6
(1 row)

QUERY: select * from rtest_t7;
 a|b                                  
--+-----------------------------------
19|Record should go to rtest_t5 and t7
(1 row)

QUERY: select * from rtest_t8;
 a|b                                  
--+-----------------------------------
26|Record should go to rtest_t4 and t8
28|Record should go to rtest_t4 and t8
(2 rows)

QUERY: delete from rtest_t4;
QUERY: delete from rtest_t5;
QUERY: delete from rtest_t6;
QUERY: delete from rtest_t7;
QUERY: delete from rtest_t8;
QUERY: insert into rtest_t9 values (1, 'Record should go to rtest_t4');
QUERY: insert into rtest_t9 values (2, 'Record should go to rtest_t4');
QUERY: insert into rtest_t9 values (10, 'Record should go to rtest_t5');
QUERY: insert into rtest_t9 values (15, 'Record should go to rtest_t5');
QUERY: insert into rtest_t9 values (19, 'Record should go to rtest_t5 and t7');
QUERY: insert into rtest_t9 values (20, 'Record should go to rtest_t4 and t6');
QUERY: insert into rtest_t9 values (26, 'Record should go to rtest_t4 and t8');
QUERY: insert into rtest_t9 values (28, 'Record should go to rtest_t4 and t8');
QUERY: insert into rtest_t9 values (30, 'Record should go to rtest_t4');
QUERY: insert into rtest_t9 values (40, 'Record should go to rtest_t4');
QUERY: insert into rtest_t4 select * from rtest_t9 where a < 20;
QUERY: select * from rtest_t4;
a|b                           
-+----------------------------
1|Record should go to rtest_t4
2|Record should go to rtest_t4
(2 rows)

QUERY: select * from rtest_t5;
 a|b                                  
--+-----------------------------------
10|Record should go to rtest_t5       
15|Record should go to rtest_t5       
19|Record should go to rtest_t5 and t7
(3 rows)

QUERY: select * from rtest_t6;
a|b
-+-
(0 rows)

QUERY: select * from rtest_t7;
 a|b                                  
--+-----------------------------------
19|Record should go to rtest_t5 and t7
(1 row)

QUERY: select * from rtest_t8;
a|b
-+-
(0 rows)

QUERY: insert into rtest_t4 select * from rtest_t9 where b ~ 'and t8';
QUERY: select * from rtest_t4;
 a|b                                  
--+-----------------------------------
 1|Record should go to rtest_t4       
 2|Record should go to rtest_t4       
26|Record should go to rtest_t4 and t8
28|Record should go to rtest_t4 and t8
(4 rows)

QUERY: select * from rtest_t5;
 a|b                                  
--+-----------------------------------
10|Record should go to rtest_t5       
15|Record should go to rtest_t5       
19|Record should go to rtest_t5 and t7
(3 rows)

QUERY: select * from rtest_t6;
a|b
-+-
(0 rows)

QUERY: select * from rtest_t7;
 a|b                                  
--+-----------------------------------
19|Record should go to rtest_t5 and t7
(1 row)

QUERY: select * from rtest_t8;
 a|b                                  
--+-----------------------------------
26|Record should go to rtest_t4 and t8
28|Record should go to rtest_t4 and t8
(2 rows)

QUERY: insert into rtest_t4 select a + 1, b from rtest_t9 where a in (20, 30, 40);
QUERY: select * from rtest_t4;
 a|b                                  
--+-----------------------------------
 1|Record should go to rtest_t4       
 2|Record should go to rtest_t4       
26|Record should go to rtest_t4 and t8
28|Record should go to rtest_t4 and t8
21|Record should go to rtest_t4 and t6
31|Record should go to rtest_t4       
41|Record should go to rtest_t4       
(7 rows)

QUERY: select * from rtest_t5;
 a|b                                  
--+-----------------------------------
10|Record should go to rtest_t5       
15|Record should go to rtest_t5       
19|Record should go to rtest_t5 and t7
(3 rows)

QUERY: select * from rtest_t6;
 a|b                                  
--+-----------------------------------
21|Record should go to rtest_t4 and t6
(1 row)

QUERY: select * from rtest_t7;
 a|b                                  
--+-----------------------------------
19|Record should go to rtest_t5 and t7
(1 row)

QUERY: select * from rtest_t8;
 a|b                                  
--+-----------------------------------
26|Record should go to rtest_t4 and t8
28|Record should go to rtest_t4 and t8
(2 rows)

QUERY: insert into rtest_order1 values (1);
QUERY: select * from rtest_order2;
a|b|c                                  
-+-+-----------------------------------
1|1|rule 2 - this should run 1st       
1|2|rule 4 - this should run 2nd       
1|3|rule 3 - this should run 3rd or 4th
1|4|rule 1 - this should run 3rd or 4th
(4 rows)

QUERY: insert into rtest_nothn1 values (1, 'want this');
QUERY: insert into rtest_nothn1 values (2, 'want this');
QUERY: insert into rtest_nothn1 values (10, 'don''t want this');
QUERY: insert into rtest_nothn1 values (19, 'don''t want this');
QUERY: insert into rtest_nothn1 values (20, 'want this');
QUERY: insert into rtest_nothn1 values (29, 'want this');
QUERY: insert into rtest_nothn1 values (30, 'don''t want this');
QUERY: insert into rtest_nothn1 values (39, 'don''t want this');
QUERY: insert into rtest_nothn1 values (40, 'want this');
QUERY: insert into rtest_nothn1 values (50, 'want this');
QUERY: insert into rtest_nothn1 values (60, 'want this');
QUERY: select * from rtest_nothn1;
 a|b        
--+---------
 1|want this
 2|want this
20|want this
29|want this
40|want this
50|want this
60|want this
(7 rows)

QUERY: insert into rtest_nothn2 values (10, 'too small');
QUERY: insert into rtest_nothn2 values (50, 'too small');
QUERY: insert into rtest_nothn2 values (100, 'OK');
QUERY: insert into rtest_nothn2 values (200, 'OK');
QUERY: select * from rtest_nothn2;
a|b
-+-
(0 rows)

QUERY: select * from rtest_nothn3;
  a|b 
---+--
100|OK
200|OK
(2 rows)

QUERY: delete from rtest_nothn1;
QUERY: delete from rtest_nothn2;
QUERY: delete from rtest_nothn3;
QUERY: insert into rtest_nothn4 values (1, 'want this');
QUERY: insert into rtest_nothn4 values (2, 'want this');
QUERY: insert into rtest_nothn4 values (10, 'don''t want this');
QUERY: insert into rtest_nothn4 values (19, 'don''t want this');
QUERY: insert into rtest_nothn4 values (20, 'want this');
QUERY: insert into rtest_nothn4 values (29, 'want this');
QUERY: insert into rtest_nothn4 values (30, 'don''t want this');
QUERY: insert into rtest_nothn4 values (39, 'don''t want this');
QUERY: insert into rtest_nothn4 values (40, 'want this');
QUERY: insert into rtest_nothn4 values (50, 'want this');
QUERY: insert into rtest_nothn4 values (60, 'want this');
QUERY: insert into rtest_nothn1 select * from rtest_nothn4;
QUERY: select * from rtest_nothn1;
 a|b        
--+---------
 1|want this
 2|want this
20|want this
29|want this
40|want this
50|want this
60|want this
(7 rows)

QUERY: delete from rtest_nothn4;
QUERY: insert into rtest_nothn4 values (10, 'too small');
QUERY: insert into rtest_nothn4 values (50, 'too small');
QUERY: insert into rtest_nothn4 values (100, 'OK');
QUERY: insert into rtest_nothn4 values (200, 'OK');
QUERY: insert into rtest_nothn2 select * from rtest_nothn4;
QUERY: select * from rtest_nothn2;
a|b
-+-
(0 rows)

QUERY: select * from rtest_nothn3;
  a|b 
---+--
100|OK
200|OK
(2 rows)

