%.so: %.o
	$(LD) -x -r -o $<.obj $<
	@echo building shared object $@
	@rm -f $@.pic
	@${AR} cq $@.pic `lorder $<.obj | tsort`
	${RANLIB} $@.pic
	@rm -f $@
ifdef ELF_SYSTEM
	$(LD) -x -Bshareable -o $@ $@.pic
else
        $(LD) -x -Bshareable -Bforcearchive -o $@ $@.pic
endif

